<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Work in Progress</title>
  <style>
    html,body {
      height:100%;
      margin:0;
      background:#000;
      font-family:system-ui,-apple-system,"Segoe UI",Roboto,Arial;
      overflow:hidden;
    }

    /* Background video */
    .bg-video {
      position:fixed;
      inset:0;
      width:100%;
      height:100%;
      object-fit:cover;
      z-index:0;
      pointer-events:none;
      filter:brightness(0.67);
    }

    /* Center overlay (text) */
    .overlay {
      position:fixed;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      z-index:5;
      user-select:none;
    }

    .center-stack {
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:.5rem;
      text-align:center;
      cursor:pointer; /* whole page clickable anyway */
    }

    h1 {
      margin:0;
      color:#fff;
      font-size:clamp(2rem,6vw,4rem);
      letter-spacing:.04em;
      text-transform:uppercase;
      font-weight:700;
      text-shadow:0 6px 14px rgba(0,0,0,.6);
      transition:opacity .45s ease, transform .45s ease;
      will-change:opacity,transform;
      pointer-events: none;
    }

    /* hidden state used when secret overlays */
    .hidden {
      opacity:0 !important;
      transform:translateY(6px) scale(.995);
      pointer-events:none;
    }

    /* Secret overlay: contains the secret video (with poster) or fallback image + text */
    .secret {
      position:fixed;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      z-index:10;
      opacity:0;
      pointer-events:none;
      transition:opacity .45s ease;
    }
    .secret.visible {
      opacity:1;
      pointer-events:auto;
    }

    .secret-inner {
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:1rem;
      text-align:center;
      padding: 0.5rem;
      max-width: 92vw;
    }

    .secret video, .secret img {
      max-width:85vw;
      max-height:70vh;
      width:auto;
      height:auto;
      object-fit:contain;
      border-radius:6px;
      box-shadow:0 10px 30px rgba(0,0,0,.6);
      opacity:0;
      transform: scale(0.995);
      transition: opacity .35s ease, transform .35s ease;
    }

    .secret.visible video,
    .secret.visible img {
      opacity:1;
      transform: none;
    }

    .secret p {
      margin:0;
      color:#fff;
      font-size:clamp(1rem,2.8vw,1.25rem);
      font-weight:600;
      text-shadow:0 4px 10px rgba(0,0,0,.6);
    }

    @media (prefers-reduced-motion:reduce) {
      * { transition:none !important; animation:none !important; }
    }
  </style>
</head>
<body>

  <!-- background video (muted so autoplay works) -->
  <video id="bgVideo" class="bg-video" muted autoplay playsinline preload="auto" loop>
    <source src="background.mp4" type="video/mp4" />
    <!-- If video missing, fallback JS sets body background -->
  </video>

  <!-- center overlay -->
  <div class="overlay">
    <div class="center-stack" id="centerStack" tabindex="0" aria-label="Secret trigger area">
      <h1 id="mainHeading">Work in Progress</h1>
    </div>
  </div>

  <!-- secret overlay - contains secret video (with poster kiwi.jpeg) and text -->
  <div class="secret" id="secretOverlay" aria-hidden="true">
    <div class="secret-inner">
      <!-- secret video: uses kiwi.mp4 if available, uses kiwi.jpeg as poster -->
      <video id="secretVideo" poster="kiwi.jpeg" playsinline preload="auto" controlsList="nodownload" style="background:#000">
        <source src="kiwi.mp4" type="video/mp4" />
        <!-- if browser can't play video, the JS will show the poster image instead -->
      </video>
      <p id="secretText">Kiwi says be patient!</p>
    </div>
  </div>

  <script>
  (function () {
    /* ---------- CONFIG ---------- */
    const WINDOW_MS = 2000;   // 2 seconds
    const NEEDED = 10;        // 10 clicks
    const MAX_FALLBACK_MS = 3500; // if secret video doesn't exist, show poster for this long

    /* ---------- ELEMENTS ---------- */
    const bg = document.getElementById('bgVideo');
    const centerStack = document.getElementById('centerStack');
    const mainHeading = document.getElementById('mainHeading');
    const secretOverlay = document.getElementById('secretOverlay');
    const secretVideo = document.getElementById('secretVideo');

    /* ---------- VIDEO PLAY / FALLBACK for background ---------- */
    function useBgFallback() {
      try { bg.style.display = 'none'; } catch(e) {}
      document.body.style.background = `url("kiwi.jpeg") no-repeat center center fixed`;
      document.body.style.backgroundSize = 'cover';
      console.warn('Background video missing or blocked — using fallback image.');
    }

    function tryPlayBg() {
      if (!bg) { useBgFallback(); return; }
      bg.play().then(() => {
        console.log('Background video playing.');
      }).catch((err) => {
        console.warn('Background autoplay prevented or failed:', err);
        useBgFallback();
      });
    }

    if (bg) {
      bg.addEventListener('error', useBgFallback);
      bg.addEventListener('stalled', () => console.warn('Background video stalled.'));
      bg.addEventListener('ended', () => { bg.currentTime = 0; tryPlayBg(); /* defensive loop */ });
      if (document.readyState === 'complete' || document.readyState === 'interactive') tryPlayBg();
      else window.addEventListener('DOMContentLoaded', tryPlayBg);
    } else {
      useBgFallback();
    }

    /* ---------- CLICK DETECTION (entire page) ---------- */
    let clicks = [], secretTimeout = null, secretActive = false;

    // Show the secret overlay — plays the secret video if available
    function showSecret() {
      if (secretActive) return;
      secretActive = true;

      // hide main heading
      mainHeading.classList.add('hidden');

      // make secret visible
      secretOverlay.classList.add('visible');
      secretOverlay.setAttribute('aria-hidden', 'false');

      // Try to play secret video (likely allowed because this is triggered by user clicks)
      if (secretVideo) {
        // If the source is present, play it. If .play() fails, fallback to showing poster image.
        const sources = secretVideo.querySelectorAll('source');
        const hasSource = Array.from(sources).some(s => s.getAttribute('src'));
        if (hasSource) {
          // ensure video starts at 0
          secretVideo.currentTime = 0;
          // unmute (user gesture exists via clicks) and play with sound
          secretVideo.muted = false;
          secretVideo.play().then(() => {
            console.log('Secret video playing with sound.');
            // when it ends, hide secret
            secretVideo.onended = () => { hideSecret(); };
          }).catch(err => {
            console.warn('Secret video play prevented or failed:', err);
            // fallback to poster image display
            showPosterFallback();
          });
          // As a safety, if video doesn't end for some reason, ensure we hide after a generous time (video length), but we prefer onended.
        } else {
          // no video source — show poster fallback
          showPosterFallback();
        }
      } else {
        showPosterFallback();
      }
    }

    // Hide secret, stop/rewind video
    function hideSecret() {
      if (!secretActive) return;
      secretActive = false;

      // hide secret overlay
      secretOverlay.classList.remove('visible');
      secretOverlay.setAttribute('aria-hidden','true');

      // stop and reset secret video if present
      if (secretVideo && !secretVideo.paused) {
        try {
          secretVideo.pause();
        } catch(e) {}
      }
      try { secretVideo.currentTime = 0; } catch(e){}

      // small delay so the fade-out looks nicer before showing heading again
      setTimeout(() => {
        mainHeading.classList.remove('hidden');
      }, 120);

      // clear any fallback timeout
      if (secretTimeout) { clearTimeout(secretTimeout); secretTimeout = null; }
    }

    // If no secret video or playing fails, show the poster image for a few seconds
    function showPosterFallback() {
      // if secretVideo has poster, we can rely on it being visible; if browser doesn't show poster in <video>, we might replace with an <img> — but for simplicity the poster attribute should show while the video element is visible.
      // fallback hide after MAX_FALLBACK_MS
      if (secretTimeout) { clearTimeout(secretTimeout); secretTimeout = null; }
      secretTimeout = setTimeout(() => {
        hideSecret();
      }, MAX_FALLBACK_MS);
    }

    // register click across entire document; ignore interactive elements so normal links/controls still work
    function registerClick(e) {
      // ignore clicks on interactive elements
      const tag = (e && e.target && e.target.tagName) ? e.target.tagName.toLowerCase() : '';
      if (['a','button','input','textarea','select','label'].includes(tag)) return;

      const now = Date.now();
      clicks.push(now);
      // keep only those within WINDOW_MS
      clicks = clicks.filter(ts => now - ts <= WINDOW_MS);
      if (clicks.length >= NEEDED) {
        clicks = [];
        showSecret();
      }
    }

    // Attach listeners to whole document
    document.addEventListener('click', registerClick);
    document.addEventListener('keyup', (e) => { if (e.key === 'Enter' || e.key === ' ') registerClick(e); });

    // If user clicks while secret is visible, we ignore until it finishes. Also hide on blur so it doesn't get stuck
    window.addEventListener('blur', () => { if (secretActive) hideSecret(); });

    // small helpful console message
    console.log('Secret trigger ready: 10 clicks within 2 seconds anywhere on the page. If secret audio fails to play, open DevTools console to inspect.');
  })();
  </script>
</body>
</html>
