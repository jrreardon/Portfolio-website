<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Work in Progress</title>
  <style>
    html,body {
      height:100%;
      margin:0;
      background:#000;
      font-family:system-ui,-apple-system,"Segoe UI",Roboto,Arial;
      overflow:hidden;
    }

    /* base background video (desktop) */
    .bg-video {
      position:fixed;
      inset:0;
      width:100%;
      height:100%;
      object-fit:cover;
      z-index:0;
      pointer-events:none;
      filter:brightness(0.85);
      transition:transform 250ms ease;
    }

    /* MOBILE / PORTRAIT: rotate 90deg and center */
    .bg-video.portrait {
      /* we rotate, so swap width/height using viewport */
      width:100vh;
      height:100vw;
      top:50%;
      left:50%;
      transform:translate(-50%, -50%) rotate(90deg);
      object-fit:cover;
    }

    /* overlay text */
    .overlay {
      position:fixed;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      z-index:5;
      user-select:none;
      text-align:center;
      padding:1rem;
    }
    .center-stack {
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:.5rem;
    }
    h1 {
      margin:0;
      color:#fff;
      font-size:clamp(2rem,6vw,4rem);
      letter-spacing:.04em;
      text-transform:uppercase;
      font-weight:700;
      text-shadow:0 6px 14px rgba(0,0,0,.6);
      transition:opacity .45s ease, transform .45s ease;
      pointer-events:none;
    }
    .hidden {
      opacity:0 !important;
      transform:translateY(6px) scale(.995);
      pointer-events:none;
    }

    /* secret popup */
    .secret {
      position:fixed;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      z-index:10;
      opacity:0;
      pointer-events:none;
      transition:opacity 420ms cubic-bezier(.22,.9,.35,1);
      will-change:opacity;
    }
    .secret.visible {
      opacity:1;
      pointer-events:auto;
    }
    .secret-inner {
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:1rem;
      text-align:center;
      max-width:min(92vw, 900px);
      opacity:0;
      transform:translateZ(0) scale(.995);
      transition:opacity 420ms cubic-bezier(.22,.9,.35,1), transform 420ms cubic-bezier(.22,.9,.35,1);
    }
    .secret.visible .secret-inner {
      opacity:1;
      transform:translateZ(0) scale(1);
    }
    .secret video,
    .secret img {
      max-width:85vw;
      max-height:70vh;
      object-fit:contain;
      border-radius:6px;
      box-shadow:0 10px 30px rgba(0,0,0,.6);
      backface-visibility:hidden;
      -webkit-backface-visibility:hidden;
    }
    .secret p {
      margin:0;
      color:#fff;
      font-size:clamp(1rem,2.8vw,1.25rem);
      font-weight:600;
      text-shadow:0 4px 10px rgba(0,0,0,.6);
    }

    /* make the popup media a bit smaller on narrow screens so you donâ€™t have to zoom out */
    @media (max-width: 768px) {
      .secret video,
      .secret img {
        max-width: 96vw;
        max-height: 60vh;
      }
      h1 {
        font-size: clamp(1.8rem, 9vw, 3rem);
      }
    }

    @media (prefers-reduced-motion:reduce) {
      * { transition:none !important; animation:none !important; }
    }
  </style>
</head>
<body>

  <!-- background video -->
  <video id="bgVideo" class="bg-video" muted autoplay playsinline preload="auto" loop>
    <source src="background.mp4" type="video/mp4" />
  </video>

  <!-- centered text -->
  <div class="overlay">
    <div class="center-stack" id="centerStack" tabindex="0">
      <h1 id="mainHeading">Work in Progress</h1>
    </div>
  </div>

  <!-- secret popup -->
  <div class="secret" id="secretOverlay" aria-hidden="true">
    <div class="secret-inner">
      <video
        id="secretVideo"
        poster="kiwi.jpeg"
        playsinline
        webkit-playsinline
        preload="auto"
        controlsList="nodownload"
      >
        <source src="kiwi.mp4" type="video/mp4" />
      </video>
      <p>Be patient!</p>
    </div>
  </div>

  <script>
  (function () {
    /* ====== CONFIG ====== */
    const WINDOW_MS = 2000;   // 2 seconds
    const NEEDED    = 10;     // 10 clicks
    const POST_SHOW_MS = 600; // after secret video ends, stay up for 0.6s
    const MAX_FALLBACK_MS = 3500; // if secret video can't play, show poster this long

    /* ====== ELEMENTS ====== */
    const bgVideo       = document.getElementById('bgVideo');
    const mainHeading   = document.getElementById('mainHeading');
    const secretOverlay = document.getElementById('secretOverlay');
    const secretVideo   = document.getElementById('secretVideo');

    /* ====== ORIENTATION HANDLING FOR BACKGROUND ====== */
    function applyVideoOrientation() {
      if (!bgVideo) return;
      const isPortrait = window.matchMedia("(orientation: portrait)").matches;
      if (isPortrait) {
        bgVideo.classList.add('portrait');
      } else {
        bgVideo.classList.remove('portrait');
      }
    }
    // run on load
    applyVideoOrientation();
    // run on rotate/orientation change
    window.addEventListener('resize', applyVideoOrientation);
    window.addEventListener('orientationchange', applyVideoOrientation);

    // try to start bg video, but if mobile blocks it, just leave it there (no more hiding to black-with-kiwi)
    if (bgVideo) {
      bgVideo.play().catch(() => {
        // mobile may block autoplay with sound, but it's muted so it should usually work.
        // we DON'T hide it anymore; we just let it sit black.
        console.warn("Background video couldn't autoplay (mobile likely). Leaving black background.");
      });
    }

    /* ====== SECRET LOGIC ====== */
    let clicks = [];
    let secretTimeout = null;
    let secretActive = false;

    function clearSecretTimeout() {
      if (secretTimeout) {
        clearTimeout(secretTimeout);
        secretTimeout = null;
      }
    }

    function showSecret() {
      if (secretActive) return;
      secretActive = true;
      clearSecretTimeout();

      // fade out main text
      mainHeading.classList.add('hidden');

      // show secret overlay
      secretOverlay.classList.add('visible');
      secretOverlay.setAttribute('aria-hidden','false');

      // try to play secret video with sound (we have user interaction: 10 clicks)
      if (secretVideo) {
        try { secretVideo.pause(); secretVideo.currentTime = 0; } catch(e){}
        secretVideo.muted = false;
        secretVideo.play().then(() => {
          // when video finishes (you said it's ~6s), hide after POST_SHOW_MS
          secretVideo.onended = () => {
            clearSecretTimeout();
            secretTimeout = setTimeout(hideSecret, POST_SHOW_MS);
          };
        }).catch(err => {
          console.warn("Secret video couldn't play, using poster fallback:", err);
          // show poster for a bit
          clearSecretTimeout();
          secretTimeout = setTimeout(hideSecret, MAX_FALLBACK_MS);
        });
      } else {
        // no video element at all
        clearSecretTimeout();
        secretTimeout = setTimeout(hideSecret, MAX_FALLBACK_MS);
      }
    }

    function hideSecret() {
      if (!secretActive) return;
      secretActive = false;
      clearSecretTimeout();

      secretOverlay.classList.remove('visible');
      secretOverlay.setAttribute('aria-hidden','true');

      if (secretVideo) {
        try { secretVideo.pause(); } catch(e){}
        try { secretVideo.currentTime = 0; } catch(e){}
        secretVideo.onended = null;
      }

      // bring text back after fade
      setTimeout(() => {
        mainHeading.classList.remove('hidden');
      }, 120);
    }

    /* ====== CLICK DETECTION (whole screen) ====== */
    function registerClick(e) {
      // ignore clicks on the actual video controls if they appear
      const tag = e.target && e.target.tagName ? e.target.tagName.toLowerCase() : '';
      if (['video','a','button','input','textarea','select','label'].includes(tag)) {
        return;
      }

      const now = Date.now();
      clicks.push(now);
      // keep only clicks in last WINDOW_MS
      clicks = clicks.filter(ts => now - ts <= WINDOW_MS);

      if (clicks.length >= NEEDED) {
        clicks = [];
        showSecret();
      }
    }

    document.addEventListener('click', registerClick);
    document.addEventListener('keyup', (e) => {
      if (e.key === 'Enter' || e.key === ' ') registerClick(e);
    });

    // make sure secret doesn't stay stuck if they background the tab
    window.addEventListener('blur', () => {
      if (secretActive) hideSecret();
    });
  })();
  </script>
</body>
</html>
